import { Meta, Story } from '@storybook/addon-docs';
import * as SourceStories from './Source.stories.mjs';

<Meta of={SourceStories} />

# Source

Adds a block of source code with "copy" functionality to the page.

Similar to [Storybook's Source block](https://storybook.js.org/docs/react/api/doc-block-source) but with code replacement functionality for production-ready source code and image snapshot testing compatibility.

<Story of={SourceStories.Props} />

### Implementation:

To render a source code block provide any string as `code`:

<Story of={SourceStories.Code} />

The default theme is set with the `useDarkMode` hook from [storybook-dark-mode](https://github.com/hipstersmoothie/storybook-dark-mode), but this can be overwritten with the boolean `dark`:

<Story of={SourceStories.Dark} />

> #### Note:
>
> - As `Source` is designed to show production-ready source code, it will automatically remove any use of [PropsTable](/docs/components-propstable--docs).
> - This can be disabled by setting `removePropsTable` to `false`.

### Import Path Replacements (optional):

The `Source` component can also display all [file import paths](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import) as they would be used by a consumer of your code.

By default, this functionality is disabled unless `process.env.IMPORT_PATH_REPLACEMENTS` has a value - a stringified "key-value pair" object:

- `[key]` - a string pattern to match within an import path.
- `[value]` - a string to replace the matched `[key]` pattern string.

To use import path replacements globally, you can add this configuration with [Storybook environment variables](https://storybook.js.org/docs/react/configure/environment-variables#using-storybook-configuration):

<Story of={SourceStories.Env} />

> #### Note:
>
> - You can alternatively use a `.env` file to set `IMPORT_PATH_REPLACEMENTS`.
> - Import path replacements are performed in order.

Alternatively you can supply your own value for `importPathReplacements` directly on each instance of `Source`.

You can also disable import path replacements on each instance of `Source` by setting `importPathReplacements` to `false`.

For further control, you can also use the inline comment `// preserve-path` to opt-out of the import path replacement:

<Story of={SourceStories.Component} />

<Story of={SourceStories.ComponentRaw} />

<Story of={SourceStories.ComponentRawDisplayedSource} />

> #### Note:
>
> - Any use of the `// preserve-path` will be removed from the displayed source code of each `Source` that uses import path replacements.
>
> #### See also:
>
> - [Raw Imports](/docs/configuration-raw-imports--docs) - get the source code of an imported file.
